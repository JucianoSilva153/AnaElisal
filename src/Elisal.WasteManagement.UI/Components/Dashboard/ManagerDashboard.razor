@using Elisal.WasteManagement.Application.DTOs
@inject IJSRuntime JS

<div class="space-y-8 animate-fade-in text-slate-900 dark:text-white">
    <!-- Section: Manager KPIs -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <div class="bg-white dark:bg-slate-900 p-8 rounded-3xl shadow-premium hover-premium border-l-8 border-l-red-500 relative overflow-hidden">
            <div class="absolute -right-4 -top-4 size-20 bg-red-500/5 rounded-full"></div>
            <h4 class="text-xs font-black text-slate-400 uppercase tracking-widest mb-3">Pontos Críticos</h4>
            <div class="flex items-baseline gap-2">
                <p class="text-4xl font-black text-slate-900 dark:text-white">@Stats.PontosCriticosOcupacao</p>
                <div class="px-2 py-0.5 bg-red-50 text-red-600 text-[10px] font-black rounded-full shadow-sm">CRÍTICO</div>
            </div>
            <p class="text-xs font-bold text-slate-500 mt-2 italic">> 90% de Ocupação</p>
        </div>

        <div class="bg-white dark:bg-slate-900 p-8 rounded-3xl shadow-premium hover-premium border-l-8 border-l-primary relative overflow-hidden">
            <div class="absolute -right-4 -top-4 size-20 bg-primary/5 rounded-full"></div>
            <h4 class="text-xs font-black text-slate-400 uppercase tracking-widest mb-3">Rotas Ativas</h4>
            <div class="flex items-baseline gap-2">
                <p class="text-4xl font-black text-slate-900 dark:text-white">@Stats.RotasAtivasHoje</p>
                <span class="text-xs font-black text-primary">EM OPERAÇÃO</span>
            </div>
            <p class="text-xs font-bold text-slate-500 mt-2">Monitoramento tempo real</p>
        </div>

        <div class="bg-white dark:bg-slate-900 p-8 rounded-3xl shadow-premium hover-premium border-l-8 border-l-blue-500 relative overflow-hidden">
            <div class="absolute -right-4 -top-4 size-20 bg-blue-500/5 rounded-full"></div>
            <h4 class="text-xs font-black text-slate-400 uppercase tracking-widest mb-3">Volume Mensal</h4>
            <p class="text-4xl font-black text-slate-900 dark:text-white">
                @Stats.TotalResiduosMensal <span class="text-xl font-bold text-slate-400">Ton</span>
            </p>
            <p class="text-xs font-bold text-slate-500 mt-2">Dentro da Meta</p>
        </div>

        <div class="bg-gradient-elisal p-8 rounded-3xl shadow-green-glow hover-premium text-white relative overflow-hidden">
            <span class="material-symbols-outlined absolute -right-2 -bottom-2 text-white/20 text-7xl">notifications_active</span>
            <h4 class="text-xs font-black text-white/70 uppercase tracking-widest mb-3">Alertas Sistema</h4>
            <p class="text-5xl font-black">@Stats.AlertasOperacionais</p>
            <p class="text-xs font-bold text-white/90 mt-2 uppercase tracking-tighter">Incidentes Reportados</p>
        </div>
    </div>

    <!-- Manager Focus View -->
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
        <!-- Map Monitoring -->
        <div class="lg:col-span-8 bg-white dark:bg-slate-900 rounded-3xl shadow-premium border border-slate-100 dark:border-slate-800 flex flex-col overflow-hidden">
            <div class="p-8 border-b border-slate-50 dark:border-slate-800 flex justify-between items-center">
                <h3 class="font-black text-xl text-slate-900 dark:text-white flex items-center gap-3">
                    <span class="size-8 bg-orange-500 rounded-lg flex items-center justify-center shadow-lg">
                        <span class="material-symbols-outlined text-white text-sm font-bold">sensors</span>
                    </span>
                    Monitorização de Pontos Críticos
                </h3>
            </div>
            <div class="h-[400px] relative">
                <MapComponent MapId="managerMap" InitialLat="-8.8390" InitialLng="13.2894" InitialZoom="12"/>
            </div>
        </div>

        <!-- Distribution -->
        <div class="lg:col-span-4 bg-white dark:bg-slate-900 rounded-3xl shadow-premium border border-slate-100 dark:border-slate-800 p-8">
            <h3 class="font-black text-xl text-slate-900 dark:text-white mb-8 border-l-4 border-primary pl-4 uppercase tracking-tighter">Composição de Resíduos</h3>
            <div class="space-y-8">
                @foreach (var item in Stats.DistribuicaoPorTipo)
                {
                    <div class="space-y-3">
                        <div class="flex justify-between text-sm font-black">
                            <span class="text-slate-500 uppercase tracking-widest">@item.Category</span>
                            <p class="text-slate-900 dark:text-white text-lg">@item.Percentage%</p>
                        </div>
                        <div class="w-full bg-slate-100 dark:bg-slate-800 rounded-full h-3 shadow-inner">
                            <div class="h-full rounded-full transition-all duration-1000 shadow-md" style="width: @(item.Percentage)%; background-color: @item.Color;"></div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>

    <!-- Actions Section -->
    <div class="bg-white dark:bg-slate-900 p-8 rounded-3xl shadow-premium border border-slate-100 dark:border-slate-800">
        <h3 class="font-black text-xl text-slate-900 dark:text-white mb-8">Atalhos de Gestão</h3>
        <div class="grid grid-cols-2 lg:grid-cols-4 gap-6">
            <a href="/rotas" class="flex flex-col items-center justify-center p-8 rounded-3xl bg-slate-50 dark:bg-slate-800 border border-slate-100 dark:border-slate-700 hover:border-primary hover:bg-primary-subtle transition-all gap-4 group shadow-sm hover:shadow-lg">
                <div class="size-14 bg-white dark:bg-slate-900 rounded-2xl flex items-center justify-center shadow-premium text-primary group-hover:scale-110 transition-transform">
                    <span class="material-symbols-outlined text-2xl font-bold">route</span>
                </div>
                <span class="text-sm font-black text-slate-700 dark:text-slate-300 uppercase tracking-widest">Criar Rota Recurso</span>
            </a>
            <a href="/pontos-recolha" class="flex flex-col items-center justify-center p-8 rounded-3xl bg-slate-50 dark:bg-slate-800 border border-slate-100 dark:border-slate-700 hover:border-primary hover:bg-primary-subtle transition-all gap-4 group shadow-sm hover:shadow-lg">
                <div class="size-14 bg-white dark:bg-slate-900 rounded-2xl flex items-center justify-center shadow-premium text-green-600 group-hover:scale-110 transition-transform">
                    <span class="material-symbols-outlined text-2xl font-bold">location_on</span>
                </div>
                <span class="text-sm font-black text-slate-700 dark:text-slate-300 uppercase tracking-widest">Gerir Pontos</span>
            </a>
            <a href="/relatorios" class="flex flex-col items-center justify-center p-8 rounded-3xl bg-slate-50 dark:bg-slate-800 border border-slate-100 dark:border-slate-700 hover:border-primary hover:bg-primary-subtle transition-all gap-4 group shadow-sm hover:shadow-lg">
                <div class="size-14 bg-white dark:bg-slate-900 rounded-2xl flex items-center justify-center shadow-premium text-orange-600 group-hover:scale-110 transition-transform">
                    <span class="material-symbols-outlined text-2xl font-bold">analytics</span>
                </div>
                <span class="text-sm font-black text-slate-700 dark:text-slate-300 uppercase tracking-widest">Gerar Relatório</span>
            </a>
            <a href="/usuarios" class="flex flex-col items-center justify-center p-8 rounded-3xl bg-slate-50 dark:bg-slate-800 border border-slate-100 dark:border-slate-700 hover:border-primary hover:bg-primary-subtle transition-all gap-4 group shadow-sm hover:shadow-lg">
                <div class="size-14 bg-white dark:bg-slate-900 rounded-2xl flex items-center justify-center shadow-premium text-purple-600 group-hover:scale-110 transition-transform">
                    <span class="material-symbols-outlined text-2xl font-bold">group</span>
                </div>
                <span class="text-sm font-black text-slate-700 dark:text-slate-300 uppercase tracking-widest">Alocar Operadores</span>
            </a>
        </div>
    </div>
</div>

@code {
    [Parameter] public DashboardStatsDto Stats { get; set; } = new();
}
